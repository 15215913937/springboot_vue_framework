"use strict";(self["webpackChunkspringboot_vue_shenqn"]=self["webpackChunkspringboot_vue_shenqn"]||[]).push([[760],{9760:function(e,l,a){a.r(l),a.d(l,{default:function(){return x}});var t=a(6252),o=a(3577);const i={style:{padding:"10px"}},r={style:{margin:"10px 0"}},s=(0,t.Uk)("  新增 "),d=(0,t.Uk)("  导出 "),n={style:{margin:"10px 0",display:"block",clear:"both"}},m=(0,t.Uk)("查询"),u=(0,t.Uk)("重置"),p=(0,t.Uk)("  批量删除 "),h=(0,t.Uk)("编辑"),c={style:{margin:"10px 0"}},g=(0,t.Uk)("点击上传"),f=(0,t._)("div",{slot:"tip",style:{"font-size":"13px"}},"只能上传jpg/png文件，且不超过1M",-1),b={class:"dialog-footer"},w=(0,t.Uk)("取消"),W=(0,t.Uk)("提交");function y(e,l,a,y,k,V){const _=(0,t.up)("CirclePlus"),C=(0,t.up)("el-icon"),U=(0,t.up)("el-button"),v=(0,t.up)("Upload"),x=(0,t.up)("el-input"),S=(0,t.up)("Delete"),D=(0,t.up)("el-popconfirm"),z=(0,t.up)("el-table-column"),$=(0,t.up)("el-image"),Y=(0,t.up)("el-pagination"),P=(0,t.up)("el-table"),Z=(0,t.up)("el-upload"),M=(0,t.up)("el-form-item"),j=(0,t.up)("el-option"),B=(0,t.up)("el-select"),H=(0,t.up)("el-date-picker"),I=(0,t.up)("el-form"),N=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("div",r,[(0,t.Wm)(U,{type:"primary",onClick:V.add},{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Wm)(_)])),_:1}),s])),_:1},8,["onClick"]),(0,t.Wm)(U,{type:"success",onClick:V.exportbooks},{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1}),d])),_:1},8,["onClick"])]),(0,t._)("div",n,[(0,t.Wm)(x,{modelValue:k.name,"onUpdate:modelValue":l[0]||(l[0]=e=>k.name=e),placeholder:"请输入书名",style:{width:"15%"},class:"mr-10","prefix-icon":y.Search,clearable:""},null,8,["modelValue","prefix-icon"]),(0,t.Wm)(x,{modelValue:k.author,"onUpdate:modelValue":l[1]||(l[1]=e=>k.author=e),placeholder:"请输入作者",style:{width:"15%"},"prefix-icon":y.Search,class:"mr-10",clearable:""},null,8,["modelValue","prefix-icon"]),(0,t.Wm)(x,{modelValue:k.category,"onUpdate:modelValue":l[2]||(l[2]=e=>k.category=e),placeholder:"请输入类别",style:{width:"15%"},"prefix-icon":y.Search,class:"mr-10",clearable:""},null,8,["modelValue","prefix-icon"]),(0,t.Wm)(U,{class:"mb-10",type:"primary",onClick:V.load},{default:(0,t.w5)((()=>[m])),_:1},8,["onClick"]),(0,t.Wm)(U,{class:"mb-10",type:"primary",onClick:V.reset},{default:(0,t.w5)((()=>[u])),_:1},8,["onClick"]),(0,t.Wm)(D,{title:"确定要删除吗",onConfirm:V.deleteBatch},{reference:(0,t.w5)((()=>[(0,t.Wm)(U,{class:"mb-10",type:"danger",style:{float:"right","margin-right":"10px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Wm)(S)])),_:1}),p])),_:1})])),_:1},8,["onConfirm"])]),(0,t.Wm)(P,{data:k.tableData,border:"",stripe:"",style:{width:"100%"},onSelectionChange:V.handleSelectionChange,"highlight-current-row":""},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{type:"selection"}),(0,t.Wm)(z,{prop:"id",label:"ID",sortable:"",width:"70px"}),(0,t.Wm)(z,{label:"封面"},{default:(0,t.w5)((e=>[(0,t.Wm)($,{style:{width:"100%",height:"90px"},src:e.row.cover,"preview-src-list":[e.row.cover],"hide-on-click-modal":"true","preview-teleported":"true"},null,8,["src","preview-src-list"])])),_:1}),(0,t.Wm)(z,{prop:"bookname",label:"书名"}),(0,t.Wm)(z,{prop:"author",label:"作者"}),(0,t.Wm)(z,{prop:"category",label:"类别"}),(0,t.Wm)(z,{prop:"version",label:"版本"}),(0,t.Wm)(z,{prop:"publishingHouse",label:"出版社"}),(0,t.Wm)(z,{prop:"purchaser",label:"购买人"}),(0,t.Wm)(z,{prop:"price",label:"价格"}),(0,t.Wm)(z,{prop:"buyDate",label:"购书日期"}),(0,t.Wm)(z,{prop:"comment",label:"备注"}),(0,t.Wm)(z,{fixed:"right",label:"操作",width:"150px"},{default:(0,t.w5)((e=>[(0,t.Wm)(U,{plain:"",type:"primary",onClick:l=>V.handleEdit(e.row)},{default:(0,t.w5)((()=>[h])),_:2},1032,["onClick"]),(0,t.Wm)(D,{title:"你确定要删除吗?",onConfirm:l=>V.handleDelete(e.row)},{reference:(0,t.w5)((()=>[(0,t.Wm)(U,{type:"danger"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Wm)(S)])),_:1})])),_:1})])),_:2},1032,["onConfirm"])])),_:1}),(0,t.Wm)(Y,{small:"",layout:"prev, pager, next",total:50})])),_:1},8,["data","onSelectionChange"]),(0,t._)("div",c,[(0,t.Wm)(Y,{currentPage:k.currentPage,"onUpdate:currentPage":l[3]||(l[3]=e=>k.currentPage=e),"page-size":k.pageSize,"onUpdate:page-size":l[4]||(l[4]=e=>k.pageSize=e),"page-sizes":[10,20,50],small:e.small,disabled:e.disabled,background:e.background,layout:"total, sizes, prev, pager, next, jumper",total:k.total,onSizeChange:V.handleSizeChange,onCurrentChange:V.handleCurrentChange},null,8,["currentPage","page-size","small","disabled","background","total","onSizeChange","onCurrentChange"]),(0,t.Wm)(N,{modelValue:k.dialogVisible,"onUpdate:modelValue":l[15]||(l[15]=e=>k.dialogVisible=e),title:"新增图书",width:"30%"},{footer:(0,t.w5)((()=>[(0,t._)("span",b,[(0,t.Wm)(U,{onClick:l[14]||(l[14]=e=>k.dialogVisible=!1)},{default:(0,t.w5)((()=>[w])),_:1}),(0,t.Wm)(U,{type:"primary",onClick:V.save,loading:e.loading},{default:(0,t.w5)((()=>[W])),_:1},8,["onClick","loading"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(I,{model:"form","label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(M,{label:"封面"},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{ref:"upload",action:k.filesUploadUrl,"on-success":V.fileUploadSuccess},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{type:"primary"},{default:(0,t.w5)((()=>[g])),_:1})])),_:1},8,["action","on-success"]),f])),_:1}),(0,t.Wm)(M,{label:"书名"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:k.form.bookname,"onUpdate:modelValue":l[5]||(l[5]=e=>k.form.bookname=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"作者"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:k.form.author,"onUpdate:modelValue":l[6]||(l[6]=e=>k.form.author=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"类别"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:k.form.category,"onUpdate:modelValue":l[7]||(l[7]=e=>k.form.category=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"版本"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:k.form.version,"onUpdate:modelValue":l[8]||(l[8]=e=>k.form.version=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"出版社"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:k.form.publishingHouse,"onUpdate:modelValue":l[9]||(l[9]=e=>k.form.publishingHouse=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"购买人"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:k.form.purchaser,"onUpdate:modelValue":l[10]||(l[10]=e=>k.form.purchaser=e),clearable:"",placeholder:"选择购买人",style:{width:"80%"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(k.options,(e=>((0,t.wg)(),(0,t.j4)(j,{key:e.id,label:e.name,value:e.name},{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.j4)((0,t.LL)(e.value)))])),_:2},1024),(0,t._)("span",null,(0,o.zw)(e.name),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"价格"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:k.form.price,"onUpdate:modelValue":l[11]||(l[11]=e=>k.form.price=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"购书日期"},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{modelValue:k.form.buyDate,"onUpdate:modelValue":l[12]||(l[12]=e=>k.form.buyDate=e),type:"date",clearable:"",style:{width:"80%"},format:"YYYY/MM/DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{label:"备注"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{type:"textarea",modelValue:k.form.comment,"onUpdate:modelValue":l[13]||(l[13]=e=>k.form.comment=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])}var k=a(4471),V=a(5781),_=a(2618),C={name:"Book",components:{},data(){return{form:{},dialogVisible:!1,name:"",author:"",category:"",currentPage:1,pageSize:10,total:10,tableData:[],multipleSelection:[],ids:[],filesUploadUrl:"http://"+_.I+":9090/files/upload",options:[]}},created(){this.load()},setup(){return{Search:V.Search,Delete:V.Delete,Upload:V.Upload}},methods:{deleteBatch(){this.ids.length?k.Z.post("/book/deleteBatch",this.ids).then((e=>{"0"===e.code?(this.$message.success("批量删除成功"),this.load()):this.$message.error(e.msg)})):this.$message.warning("请选择要删除的书籍")},handleSelectionChange(e){this.ids=e.map((e=>e.id))},fileUploadSuccess(e){this.form.cover=e.data},reset(){this.name="",this.author="",this.category="",this.load()},load(){k.Z.get("/book",{params:{pageNum:this.currentPage,pageSize:this.pageSize,name:this.name,author:this.author,category:this.category}}).then((e=>{this.tableData=e.data.records,this.total=e.data.total}))},add(){this.dialogVisible=!0,this.form={},this.$nextTick((()=>{this.$refs["upload"]&&this.$refs["upload"].clearFiles()})),k.Z.get("/user").then((e=>{this.options=e.data.records}))},save(){this.loading=!0,setTimeout((()=>{this.loading=!1}),1e3),this.form.id?k.Z.put("/book",this.form).then((e=>{"0"===e.code?this.$message.success("修改成功"):this.$message.error(e.msg),this.load(),this.dialogVisible=!1})):k.Z.post("/book",this.form).then((e=>{"0"===e.code?this.$message.success("新增成功"):this.$message.error(e.msg),this.load(),this.dialogVisible=!1}))},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.dialogVisible=!0,this.$nextTick((()=>{this.$refs["upload"]&&this.$refs["upload"].clearFiles()})),k.Z.get("/user").then((e=>{this.options=e.data.records}))},handleDelete(e){this.id=e.id,k.Z["delete"]("/book/"+this.id).then((e=>{"0"===e.code?this.$message.success("删除成功"):this.$message.error(e.msg),this.load()}))},handleSizeChange(){this.load()},handleCurrentChange(){this.load()},exportbooks(){window.open("http://"+_.I+":9090/book/export")}}},U=a(3744);const v=(0,U.Z)(C,[["render",y]]);var x=v}}]);
//# sourceMappingURL=760.bb7aa366.js.map