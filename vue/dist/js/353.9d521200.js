"use strict";(self["webpackChunkspringboot_vue_shenqn"]=self["webpackChunkspringboot_vue_shenqn"]||[]).push([[353],{1353:function(e,l,a){a.r(l),a.d(l,{default:function(){return D}});var t=a(6252);const o={style:{padding:"10px"}},i={style:{margin:"10px 0"}},s=(0,t.Uk)("  新增 "),d={style:{margin:"10px 0",display:"block",clear:"both"}},n=(0,t.Uk)("查询"),r=(0,t.Uk)("重置"),m=(0,t.Uk)(" 分配菜单 "),u=(0,t.Uk)("编辑"),p={style:{margin:"10px 0"}},h={class:"dialog-footer"},c=(0,t.Uk)("取消"),g=(0,t.Uk)("提交"),f={class:"dialog-footer"},w=(0,t.Uk)("取消"),k=(0,t.Uk)("提交");function b(e,l,a,b,y,W){const V=(0,t.up)("CirclePlus"),_=(0,t.up)("el-icon"),C=(0,t.up)("el-button"),D=(0,t.up)("el-input"),x=(0,t.up)("el-table-column"),U=(0,t.up)("Menu"),v=(0,t.up)("Delete"),$=(0,t.up)("el-popconfirm"),S=(0,t.up)("el-table"),Z=(0,t.up)("el-tree"),M=(0,t.up)("el-dialog"),I=(0,t.up)("el-form-item"),R=(0,t.up)("el-form"),q=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",o,[(0,t._)("div",i,[(0,t.Wm)(C,{type:"primary",onClick:W.add},{default:(0,t.w5)((()=>[(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(V)])),_:1}),s])),_:1},8,["onClick"])]),(0,t._)("div",d,[(0,t.Wm)(D,{modelValue:y.role,"onUpdate:modelValue":l[0]||(l[0]=e=>y.role=e),placeholder:"请输入角色名称",style:{width:"20%"},class:"mr-10","prefix-icon":b.Search,clearable:""},null,8,["modelValue","prefix-icon"]),(0,t.Wm)(C,{class:"mb-10",type:"primary",onClick:W.load},{default:(0,t.w5)((()=>[n])),_:1},8,["onClick"]),(0,t.Wm)(C,{class:"mb-10",type:"primary",onClick:W.reset},{default:(0,t.w5)((()=>[r])),_:1},8,["onClick"])]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(S,{data:y.tableData,border:"",stripe:"",style:{width:"100%"},onSelectionChange:e.handleSelectionChange},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{type:"selection",width:"55"}),(0,t.Wm)(x,{prop:"id",label:"ID",sortable:""}),(0,t.Wm)(x,{prop:"role",label:"角色"}),(0,t.Wm)(x,{prop:"flag",label:"唯一标识"}),(0,t.Wm)(x,{prop:"description",label:"描述"}),(0,t.Wm)(x,{fixed:"right",label:"操作",width:"300px"},{default:(0,t.w5)((e=>[(0,t.Wm)(C,{plain:"",type:"success",onClick:l=>W.selectMenu(e.row.id)},{default:(0,t.w5)((()=>[(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(U)])),_:1}),m])),_:2},1032,["onClick"]),(0,t.Wm)(C,{plain:"",type:"primary",onClick:l=>W.handleEdit(e.row)},{default:(0,t.w5)((()=>[u])),_:2},1032,["onClick"]),(0,t.Wm)($,{title:"你确定要删除吗?",onConfirm:l=>W.handleDelete(e.row)},{reference:(0,t.w5)((()=>[(0,t.Wm)(C,{type:"danger"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1})])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data","onSelectionChange"])),[[q,y.loading]]),(0,t._)("div",p,[(0,t.Wm)(M,{modelValue:y.menuDialogVis,"onUpdate:modelValue":l[2]||(l[2]=e=>y.menuDialogVis=e),title:"菜单分配",width:"30%"},{footer:(0,t.w5)((()=>[(0,t._)("span",h,[(0,t.Wm)(C,{onClick:l[1]||(l[1]=e=>y.menuDialogVis=!1)},{default:(0,t.w5)((()=>[c])),_:1}),(0,t.Wm)(C,{type:"primary",onClick:W.saveRoleMenu,loading:y.loading},{default:(0,t.w5)((()=>[g])),_:1},8,["onClick","loading"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(Z,{props:y.props,data:y.menuData,"node-key":"id",ref:"tree","default-expanded-keys":y.expends,"default-checked-keys":y.checks,"show-checkbox":""},null,8,["props","data","default-expanded-keys","default-checked-keys"])])),_:1},8,["modelValue"]),(0,t.Wm)(M,{modelValue:y.dialogVisible,"onUpdate:modelValue":l[7]||(l[7]=e=>y.dialogVisible=e),title:"角色信息",width:"30%"},{footer:(0,t.w5)((()=>[(0,t._)("span",f,[(0,t.Wm)(C,{onClick:l[6]||(l[6]=e=>y.dialogVisible=!1)},{default:(0,t.w5)((()=>[w])),_:1}),(0,t.Wm)(C,{type:"primary",onClick:W.save,loading:y.loading},{default:(0,t.w5)((()=>[k])),_:1},8,["onClick","loading"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(R,{model:"form","label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{label:"角色"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{modelValue:y.form.role,"onUpdate:modelValue":l[3]||(l[3]=e=>y.form.role=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"唯一标识"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{modelValue:y.form.flag,"onUpdate:modelValue":l[4]||(l[4]=e=>y.form.flag=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"描述"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{type:"textarea",modelValue:y.form.description,"onUpdate:modelValue":l[5]||(l[5]=e=>y.form.description=e),style:{width:"80%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])}var y=a(4471),W=a(5781),V={name:"Role",components:{},data(){return{loading:!0,form:{},menuDialogVis:!1,dialogVisible:!1,role:"",tableData:[],menuData:[],props:{label:"name"},roleId:0,expends:[],checks:[]}},created(){this.load()},setup(){return{Search:W.Search,Delete:W.Delete}},methods:{load(){this.loading=!0,y.Z.get("/role/page").then((e=>{this.loading=!1,this.tableData=e.data.records}))},reset(){this.role="",this.load()},add(){this.dialogVisible=!0,this.form={}},save(){this.form.id?(this.loading=!0,setTimeout((()=>{this.loading=!1}),1e3),y.Z.post("/role",this.form).then((e=>{"0"===e.code?this.$message.success("修改成功"):this.$message.error(e.msg),this.load(),this.dialogVisible=!1}))):y.Z.post("/role",this.form).then((e=>{"0"===e.code?this.$message.success("新增成功"):this.$message.error(e.msg),this.load(),this.dialogVisible=!1}))},saveRoleMenu(){this.loading=!0,setTimeout((()=>{this.loading=!1}),1e3),y.Z.post("/role/roleMenu/"+this.roleId,this.$refs.tree.getCheckedKeys()).then((e=>{"0"===e.code?(this.$message.success("分配成功"),this.menuDialogVis=!1):this.$message.error(e.msg)}))},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.dialogVisible=!0},handleDelete(e){this.id=e.id,y.Z["delete"]("/role/"+this.id).then((e=>{"0"===e.code?this.$message.success("删除成功"):this.$message.error(e.msg),this.load()}))},selectMenu(e){this.roleId=e,y.Z.get("/role/roleMenu/"+this.roleId).then((e=>{this.checks=e.data})),this.menuDialogVis=!0,y.Z.get("/menu").then((e=>{this.loading=!1,this.menuData=e.data,this.expends=this.menuData.map((e=>e.id))}))}}},_=a(3744);const C=(0,_.Z)(V,[["render",b]]);var D=C}}]);
//# sourceMappingURL=353.9d521200.js.map